From 2a42e70ff077006d5a6da92251ddbb2939303f94 Mon Sep 17 00:00:00 2001
From: "Seth M. Larson" <SethMichaelLarson@users.noreply.github.com>
Date: Tue, 27 Mar 2018 14:44:51 -0500
Subject: [PATCH] Move DEFAULT_REDIRECT_HEADERS_BLACKLIST under Retry

---
 urllib3/util/retry.py | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

diff --git a/urllib3/util/retry.py b/urllib3/util/retry.py
index 37a3a74e9..948c15926 100644
--- a/urllib3/util/retry.py
+++ b/urllib3/util/retry.py
@@ -20,9 +20,6 @@
 log = logging.getLogger(__name__)
 
 
-DEFAULT_REDIRECT_HEADERS_BLACKLIST = ['Authorization']
-
-
 # Data structure for representing the metadata of requests that result in a retry.
 RequestHistory = namedtuple('RequestHistory', ["method", "url", "error",
                                                "status", "redirect_location"])
@@ -154,6 +151,8 @@ class Retry(object):
 
     RETRY_AFTER_STATUS_CODES = frozenset([413, 429, 503])
 
+    DEFAULT_REDIRECT_HEADERS_BLACKLIST = frozenset(['Authorization'])
+
     #: Maximum backoff time.
     BACKOFF_MAX = 120
 
@@ -173,7 +172,7 @@ def __init__(self, total=10, connect=None, read=None, redirect=None, status=None
             raise_on_redirect = False
 
         if remove_headers_on_redirect is None:
-            remove_headers_on_redirect = DEFAULT_REDIRECT_HEADERS_BLACKLIST
+            remove_headers_on_redirect = self.DEFAULT_REDIRECT_HEADERS_BLACKLIST
         remove_headers_on_redirect = set(remove_headers_on_redirect)
 
         self.redirect = redirect

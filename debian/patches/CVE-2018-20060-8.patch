From 3b5f27449e153ad05186beca8fbd9b134936fe50 Mon Sep 17 00:00:00 2001
From: "Seth M. Larson" <SethMichaelLarson@users.noreply.github.com>
Date: Tue, 27 Mar 2018 14:35:58 -0500
Subject: [PATCH] Add a default list of headers to strip as a global

---
 urllib3/util/retry.py | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/urllib3/util/retry.py b/urllib3/util/retry.py
index ae4401143..37a3a74e9 100644
--- a/urllib3/util/retry.py
+++ b/urllib3/util/retry.py
@@ -19,6 +19,10 @@
 
 log = logging.getLogger(__name__)
 
+
+DEFAULT_REDIRECT_HEADERS_BLACKLIST = ['Authorization']
+
+
 # Data structure for representing the metadata of requests that result in a retry.
 RequestHistory = namedtuple('RequestHistory', ["method", "url", "error",
                                                "status", "redirect_location"])
@@ -169,7 +173,7 @@ def __init__(self, total=10, connect=None, read=None, redirect=None, status=None
             raise_on_redirect = False
 
         if remove_headers_on_redirect is None:
-            remove_headers_on_redirect = ['Authorization']
+            remove_headers_on_redirect = DEFAULT_REDIRECT_HEADERS_BLACKLIST
         remove_headers_on_redirect = set(remove_headers_on_redirect)
 
         self.redirect = redirect
